<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Schulprojekt Analyse</title>
<style>
body{
    font-family: Arial, sans-serif;
    background:#f0f0f0;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    margin:0;
}
.box{
    background:white;
    padding:40px;
    border-radius:12px;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
    max-width:500px;
    text-align:center;
}
input, button{
    padding:12px;
    font-size:16px;
    margin-top:10px;
    width:80%;
}
button{
    background:#007bff;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
}
#status{
    margin-top:20px;
    font-size:15px;
    color:green;
}
.small{
    font-size:13px;
    color:#555;
}
</style>
</head>
<body>

<div class="box">
<h2>Vielen Dank für die Unterstützung</h2>
<p><strong>der Ersteller des Lotsemagazin</strong></p>
<hr>
<p>Schulprojekt – Standortanalyse</p>

<input type="text" id="name" placeholder="Dein Name (freiwillig)">
<button onclick="sendAnalyse()">Analyse senden</button>

<p class="small">
Mit Klick auf „Analyse senden“ erklärst du dich einverstanden,<br>
dass dein Standort, Name und IP-Adresse für das Schulprojekt verwendet werden.
</p>

<div id="status"></div>
</div>

<script>
function sendAnalyse() {
    const name = document.getElementById("name").value || "Anonym";

    if (!navigator.geolocation) {
        document.getElementById("status").innerText = "Geolocation wird nicht unterstützt.";
        return;
    }

    navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude.toFixed(6);
        const lon = pos.coords.longitude.toFixed(6);
        const acc = pos.coords.accuracy;
        const time = new Date().toLocaleString();

        // Daten an PHP senden, um Mail mit IP zu erstellen
        fetch('send.php', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({name, lat, lon, acc, time})
        })
        .then(r => r.text())
        .then(msg => document.getElementById("status").innerText = msg)
        .catch(() => document.getElementById("status").innerText = "Fehler beim Senden");
        
    }, () => {
        document.getElementById("status").innerText = "Standortfreigabe abgelehnt.";
    });
}
</script>

</body>
</html>
