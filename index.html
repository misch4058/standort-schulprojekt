<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Lotsemagazin Analyse</title>
<style>
body{
    font-family: Arial, sans-serif;
    background:#f0f0f0;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    margin:0;
}
.box{
    background:white;
    padding:40px;
    border-radius:12px;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
    max-width:600px;
    text-align:center;
}
input, button, textarea{
    padding:12px;
    font-size:16px;
    margin-top:10px;
    width:80%;
}
textarea{
    resize:none;
    height:120px;
}
button{
    background:#007bff;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
}
#status{
    margin-top:20px;
    font-size:15px;
    color:green;
}
.small{
    font-size:13px;
    color:#555;
}
label{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    font-size:14px;
}
</style>
</head>
<body>

<div class="box">

<h2>Vielen Dank für die Unterstützung</h2>
<p><strong>der Ersteller des Lotsemagazin</strong></p>

<hr>

<p>Lotsemagazin – Standortanalyse</p>

<input type="text" id="name" placeholder="Dein Name (freiwillig)">

<textarea readonly>
AGB / Datenschutzerklärung:

- Mit dem Klick auf „Analyse senden“ erklärst du dich einverstanden,
  dass dein Name und Standort für das Lotsemagazin verwendet werden.
- Die Daten werden ausschließlich für das Lotsemagazin genutzt.
- Teilnahme ist freiwillig.
</textarea>

<label>
<input type="checkbox" id="agb">
Ich akzeptiere die AGB / Datenschutzerklärung
</label>

<button onclick="sendAnalyse()">Analyse senden</button>

<div id="status"></div>

</div>

<script>
function sendAnalyse() {
    const name = document.getElementById("name").value || "Anonym";
    const agbChecked = document.getElementById("agb").checked;

    if(!agbChecked){
        document.getElementById("status").innerText = "Bitte akzeptiere die AGB / Datenschutzerklärung.";
        return;
    }

    if(!navigator.geolocation){
        document.getElementById("status").innerText = "Geolocation wird nicht unterstützt.";
        return;
    }

    navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        const acc = pos.coords.accuracy;
        const time = new Date().toLocaleString();

        const body = `
Schulprojekt Standortanalyse

Name: ${name}

Ort:
Breitengrad: ${lat}
Längengrad: ${lon}
Genauigkeit: ±${acc} Meter
Zeit: ${time}

Google Maps:
https://www.google.com/maps?q=${lat},${lon}

Analyse:
Teilnehmer hat freiwillig Standortdaten für Schulprojekt bereitgestellt.
        `;

        const mailtoLink = "mailto:mschoepfer@lotsebasel.onmicrosoft.com" +
                           "?subject=Schulprojekt Standortanalyse" +
                           "&body=" + encodeURIComponent(body);

        window.location.href = mailtoLink;
        document.getElementById("status").innerText = "Analyse wird im E-Mail-Programm vorbereitet ✔️";

    }, () => {
        document.getElementById("status").innerText = "Standortfreigabe abgelehnt.";
    });
}
</script>

</body>
</html>
